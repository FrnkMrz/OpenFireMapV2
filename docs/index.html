<!-- 
    =============================================================================
    PROJEKT: OpenFireMap V2 - Lernversion (Refactored)
    AUTOR: Gemini (im Auftrag von Frank März)
    DATUM: 2026-01-21 (Final: Mit Debounce, Wartestatus & Robuster Fehlerbehandlung)
    =============================================================================
    
    PROJEKT-BESCHREIBUNG & LERNZIELE:
    
    Dies ist ein persönliches Lernprojekt, um die Entwicklung moderner Webanwendungen
    (Single Page Applications) zu verstehen und anzuwenden.
    
    WAS MACHT DIESE WEBSEITE?
    Dieses Tool dient der Visualisierung von rettungsdienstlich relevanter Infrastruktur
    aus der OpenStreetMap-Datenbank.
    
    Kernfunktionen:
    1. Interaktive Karte: Zeigt Feuerwachen, Hydranten, Wassertanks und Defibrillatoren (AED).
    2. Intelligenter Zoom: 
       - Wachen erscheinen ab Zoom 12.
       - Hydranten ab Zoom 15.
       - Defibrillatoren als Punkte ab Zoom 15, als detaillierte Icons ab Zoom 17.
    3. Einsatztaktik: Klick auf einen Hydranten zeigt einen 100m-Radius (Schlauchstrecke).
    4. Export-Tools:
       - PNG-Export: Erstellt hochauflösende, druckfertige Karten mit Rahmen, Titel,
         Datum, Maßstab und Lizenzhinweisen.
       - GPX-Export: Exportiert die sichtbaren Punkte für Navigationsgeräte.
    5. Internationalisierung: Die Oberfläche passt sich automatisch der Browsersprache an
       (unterstützt DE, EN, FR, ES, IT, PL, NL, CS, DA, FI, SV, NO, PT, FL, LB, JA, KO, MS, TH, ZH, YUE, TW).
    6. Smart UX: 
       - Menüs schließen automatisch nach 10 Sekunden Inaktivität.
       - Debounce: Daten werden erst 200ms nach Ende der Bewegung geladen.
       - [NEU] Robuste Fehlerbehandlung: Unterscheidet zwischen "Kein Internet", "Server überlastet"
         und "Datenfehler" und gibt dem Nutzer klares Feedback.
       
    TECHNISCHER AUFBAU (REFACTORED):
    Die Anwendung wurde in zwei Dateien aufgeteilt, um die Übersichtlichkeit zu verbessern:
    
    1. index.html (Diese Datei):
       - Enthält die HTML-Struktur, CSS-Design und die JavaScript-Logik.
       - Lädt die externen Bibliotheken (Leaflet, Tailwind).
       
    2. translations.js (Externe Datei):
       - Enthält das gesamte Wörterbuch (Dictionary) für alle Sprachen.
       - Wird im <head> geladen und stellt die Variable 'translations' bereit.

    RECHTLICHE HINWEISE:
    Impressum und Datenschutzerklärung sind fest integriert ("Info & Recht"-Button),
    um einen rechtssicheren Betrieb zu ermöglichen.
-->
<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenFireMap.org</title>
    
    <link rel="preconnect" href="https://unpkg.com">
    <link rel="preconnect" href="https://cdn.tailwindcss.com">
    <link rel="preconnect" href="https://a.basemaps.cartocdn.com">
    <link rel="preconnect" href="https://overpass-api.de">

    <link rel="apple-touch-icon" sizes="57x57" href="favicons/apple-icon-57x57.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicons/favicon-32x32.png">

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" defer></script>
    <script src="https://cdn.tailwindcss.com" defer></script>

    <link rel="stylesheet" href="assets/css/style.css">

    <script type="module" src="assets/js/app.js" defer></script>
</head>
<body>
    <h1 class="sr-only">OpenFireMap - Interaktive Karte für Feuerwehr-Infrastruktur</h1>

    <div id="map" aria-label="Interaktive Karte" role="application"></div>
    <div id="notification-box" role="alert" aria-live="polite"></div>

    <div class="absolute top-5 left-5 z-[1000] flex gap-3">
        <div class="flex glass-panel rounded-2xl shadow-2xl p-1 border border-white/5">
            <input type="text" id="search-input" data-i18n-placeholder="search_placeholder" class="bg-transparent px-4 py-2 text-sm text-white outline-none w-48 focus:w-72 transition-all duration-500">
            <button aria-label="Suchen" class="p-2 text-slate-400 hover:text-white">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>
            </button>
        </div>
        
        <button id="locate-btn" data-i18n-title="locate_title" class="glass-panel p-3 rounded-2xl text-slate-400 hover:text-emerald-400">
             <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" /></svg>
        </button>

        <button id="layer-btn-trigger" data-i18n-title="layers_title" class="glass-panel p-3 rounded-2xl text-slate-400 hover:text-white">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7" /></svg>
        </button>

        <button id="export-btn-trigger" data-i18n-title="export_title" class="glass-panel p-3 rounded-2xl text-blue-400 hover:text-blue-300 border-blue-500/20">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" /></svg>
        </button>
    </div>

    <div class="absolute bottom-8 left-5 z-[1000]">
        <button id="btn-legal-trigger" class="glass-panel p-1.5 rounded-xl text-slate-400 hover:text-white flex items-center gap-1.5">
            <span class="text-[10px] font-bold hidden md:inline" data-i18n="legal_btn">Info & Recht</span>
        </button>
    </div>

    <div class="absolute bottom-10 right-10 z-[1000] glass-panel p-4 rounded-2xl text-[10px] text-slate-400 font-mono border border-white/5">
        <div class="flex justify-between gap-4"><span data-i18n="zoom_info">ZOOM</span><span id="zoom-val" class="text-white font-bold">14.0</span></div>
        <div class="flex justify-between gap-4"><span data-i18n="data_info">DATEN</span><span id="data-status" class="text-green-400">AKTUELL</span></div>
    </div>
</body>
</html>